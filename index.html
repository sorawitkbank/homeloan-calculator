<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô v1.0.2</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b1120;--bg2:#0f172a;--card:#131c31;--card2:#172033;
  --inp:#1a2744;--grn:#22d3a7;--blu:#38bdf8;--gld:#facc15;
  --pnk:#fb7185;--org:#fb923c;--txt:#e2e8f0;--txt2:#94a3b8;
  --mut:#64748b;--brd:#1e293b;--brd2:#334155;--r:14px;--r2:10px;
  --glow-grn:0 0 20px rgba(34,211,167,.08);
  --glow-blu:0 0 20px rgba(56,189,248,.08);
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'IBM Plex Sans Thai',sans-serif;background:var(--bg);color:var(--txt);min-height:100vh;line-height:1.7}

/* HEADER */
.hdr{background:var(--bg2);border-bottom:1px solid var(--brd);padding:16px 24px;position:sticky;top:0;z-index:100;backdrop-filter:blur(12px)}
.hdr h1{font-size:20px;font-weight:700;letter-spacing:-.3px}
.hdr h1 span{background:linear-gradient(135deg,var(--grn),var(--blu));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hdr .sub{font-size:11px;color:var(--mut);margin-top:2px;letter-spacing:.3px}

/* TABS */
.tabs{display:flex;gap:6px;background:var(--bg2);padding:8px 16px;border-bottom:1px solid var(--brd);overflow-x:auto}
.tab{padding:10px 22px;border:1px solid transparent;background:transparent;color:var(--txt2);font-family:'IBM Plex Sans Thai',sans-serif;font-size:14px;font-weight:600;border-radius:var(--r2);cursor:pointer;white-space:nowrap;transition:all .25s ease;letter-spacing:-.2px}
.tab:hover{background:var(--card);color:var(--txt);border-color:var(--brd)}
.tab.on{background:linear-gradient(135deg,rgba(34,211,167,.1),rgba(56,189,248,.08));color:var(--grn);border-color:rgba(34,211,167,.25);box-shadow:var(--glow-grn)}

/* TAB CONTENT */
.tc{display:none;padding:20px;max-width:1440px;margin:0 auto}
.tc.on{display:block;animation:fadeUp .35s ease}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}

/* SECTION TITLE */
.st{font-size:17px;font-weight:700;color:var(--txt);margin-bottom:16px;padding-bottom:10px;display:flex;align-items:center;gap:8px;border-bottom:1px solid var(--brd)}
.st .accent{color:var(--grn)}

/* CARDS */
.cd{background:var(--card);border:1px solid var(--brd);border-radius:var(--r);padding:20px;margin-bottom:16px;transition:border-color .2s}

/* INPUT */
.ig{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}
.ig label{font-size:12px;font-weight:600;color:var(--txt2);display:block;margin-bottom:4px;letter-spacing:.2px}
.ig input,.ig select{padding:10px 14px;border:1px solid var(--brd);border-radius:var(--r2);background:var(--inp);color:var(--txt);font-family:'IBM Plex Sans Thai',sans-serif;font-size:14px;width:100%;transition:all .2s}
.ig input:focus,.ig select:focus{outline:0;border-color:var(--grn);box-shadow:0 0 0 3px rgba(34,211,167,.1)}

/* RATE GRID */
.rg{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.rg .rh{font-size:11px;color:var(--mut);text-align:center;padding-bottom:4px;font-weight:500}
.rg input{width:100%;padding:10px 6px;border:1px solid var(--brd);border-radius:var(--r2);background:var(--inp);color:var(--txt);font-family:'IBM Plex Sans Thai',sans-serif;font-size:14px;text-align:center;transition:all .2s}
.rg input:focus{outline:0;border-color:var(--grn);box-shadow:0 0 0 3px rgba(34,211,167,.1)}

/* BUTTONS */
.br{display:flex;gap:10px;margin:18px 0;flex-wrap:wrap}
.b1{padding:12px 28px;border:none;border-radius:var(--r2);font-family:'IBM Plex Sans Thai',sans-serif;font-size:14px;font-weight:700;cursor:pointer;transition:all .25s;background:linear-gradient(135deg,var(--grn),#15b89a);color:var(--bg);letter-spacing:-.2px}
.b1:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(34,211,167,.25)}
.b1:active{transform:translateY(0)}
.b2{padding:12px 28px;border:1px solid var(--brd2);border-radius:var(--r2);font-family:'IBM Plex Sans Thai',sans-serif;font-size:14px;font-weight:600;cursor:pointer;background:var(--card);color:var(--txt2);transition:all .2s}
.b2:hover{border-color:var(--txt2);color:var(--txt)}

/* RECOMMEND BOX */
.rc{background:linear-gradient(135deg,rgba(250,204,21,.04),rgba(251,146,60,.03));border:1px solid rgba(250,204,21,.15);border-radius:var(--r);padding:20px;margin-bottom:16px}
.rc h3{font-size:15px;font-weight:700;color:var(--gld);margin-bottom:10px;display:flex;align-items:center;gap:6px}
.rc p{font-size:13px;color:var(--txt2);line-height:1.8;margin-bottom:6px}
.rc .hl{color:var(--gld);font-weight:700}
.rc .bullet{color:var(--gld);margin-right:4px}

/* SUMMARY TABLE (like screenshot) */
.sum-panel{background:var(--card);border:1px solid var(--brd);border-radius:var(--r);overflow:visible}
.sum-panel .panel-hdr{padding:14px 20px;font-size:15px;font-weight:700;border-bottom:1px solid var(--brd);border-radius:var(--r) var(--r) 0 0}
.sum-panel .panel-hdr.flat{color:var(--grn);border-top:3px solid var(--grn)}
.sum-panel .panel-hdr.step{color:var(--blu);border-top:3px solid var(--blu)}
.sum-panel .panel-hdr.normal{color:var(--txt2);border-top:3px solid var(--mut)}
.sum-panel .panel-hdr.yearly{color:var(--gld);border-top:3px solid var(--gld)}
.sum-panel .panel-hdr.monthly{color:var(--grn);border-top:3px solid var(--grn)}
.sum-panel .panel-hdr.bank-a{color:var(--grn);border-top:3px solid var(--grn)}
.sum-panel .panel-hdr.bank-b{color:var(--blu);border-top:3px solid var(--blu)}
.sum-panel .panel-hdr.diff{color:var(--pnk);border-top:3px solid var(--pnk)}
.sum-row{display:flex;justify-content:space-between;align-items:center;padding:11px 20px;border-bottom:1px solid rgba(30,41,59,.7);transition:background .15s}
.sum-row:hover{background:rgba(34,211,167,.02)}
.sum-row:last-child{border-bottom:none}
.sum-row .lbl{font-size:13px;color:var(--txt2);font-weight:400}
.sum-row .val{font-size:14px;font-weight:700;color:var(--txt);text-align:right;letter-spacing:-.2px}
.sum-row .val.grn{color:var(--grn)}.sum-row .val.blu{color:var(--blu)}
.sum-row .val.gld{color:var(--gld)}.sum-row .val.pnk{color:var(--pnk)}

/* DATA TABLE */
table{width:100%;border-collapse:collapse;font-size:12px}
table th{background:var(--bg2);color:var(--blu);padding:10px 8px;text-align:right;font-weight:700;font-size:11px;letter-spacing:.3px;text-transform:uppercase;border-bottom:2px solid var(--brd);position:sticky;top:0;z-index:1}
table td{padding:8px;text-align:right;border-bottom:1px solid rgba(30,41,59,.5);color:var(--txt2);font-size:12px;font-variant-numeric:tabular-nums}
table tr:hover td{background:rgba(34,211,167,.02)}
table th:first-child,table td:first-child{text-align:center}
.tw{max-height:450px;overflow-y:auto;border-radius:var(--r2);border:1px solid var(--brd)}
.tw::-webkit-scrollbar{width:5px}
.tw::-webkit-scrollbar-track{background:var(--bg2)}
.tw::-webkit-scrollbar-thumb{background:var(--brd2);border-radius:3px}

/* LAYOUTS */
.g2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}
.pos{color:var(--grn)!important}.neg{color:var(--pnk)!important}

/* BADGES */
.bg-a{display:inline-block;padding:2px 10px;border-radius:20px;font-size:11px;font-weight:700;background:rgba(34,211,167,.1);color:var(--grn);letter-spacing:.3px}
.bg-b{display:inline-block;padding:2px 10px;border-radius:20px;font-size:11px;font-weight:700;background:rgba(56,189,248,.1);color:var(--blu);letter-spacing:.3px}
.bg-d{display:inline-block;padding:2px 10px;border-radius:20px;font-size:11px;font-weight:700;background:rgba(251,113,133,.1);color:var(--pnk);letter-spacing:.3px}
.ext-inp{padding:10px 14px;border:1px solid var(--brd);border-radius:var(--r2);background:var(--inp);color:var(--txt);font-family:"IBM Plex Sans Thai",sans-serif;font-size:14px;width:100%;transition:all .2s}
.ext-inp:focus{outline:0;border-color:var(--grn);box-shadow:0 0 0 3px rgba(34,211,167,.1)}
.y3w{overflow-x:auto;-webkit-overflow-scrolling:touch;margin:0 -4px;padding:0 4px}
.y3t{width:100%;margin-top:4px;font-size:8px;border-collapse:collapse;table-layout:fixed}
.hid{display:none!important}

@media(max-width:768px){
  /* Layout: stack everything */
  .g2,.g3{grid-template-columns:1fr!important;gap:10px!important}
  .rg{grid-template-columns:repeat(2,1fr)}
  .ig{grid-template-columns:1fr}

  /* Header */
  .hdr{padding:12px 14px;position:relative}
  .hdr h1{font-size:16px}
  .hdr .sub{font-size:9px}

  /* Tabs: horizontal scroll, smaller */
  .tabs{padding:6px 8px;gap:4px}
  .tab{padding:8px 12px;font-size:12px;min-width:auto}

  /* Content area */
  .tc{padding:10px}
  .cd{padding:14px 12px}
  .st{font-size:14px;padding-bottom:8px;margin-bottom:10px}

  /* Input fields: bigger touch targets */
  .ig input,.ig select,.rg input{font-size:16px!important;padding:12px 10px!important;-webkit-appearance:none}
  .ig label{font-size:11px}
  .rg .rh{font-size:10px}

  /* Buttons: full width on mobile */
  .br{flex-direction:column}
  .b1,.b2,.btn-print{width:100%;text-align:center;padding:14px;font-size:15px}

  /* Summary panels */
  .sum-panel .panel-hdr{padding:10px 14px;font-size:13px}
  .sum-row{padding:8px 14px}
  .sum-row .lbl{font-size:11px}
  .sum-row .val{font-size:12px;max-width:55%;text-align:right;word-break:break-word}

  /* Mini 3yr table inside panels */
  .y3t{font-size:7.5px!important;table-layout:fixed!important}
  .y3t th,.y3t td{padding:2px 2px!important;font-size:7.5px!important}
  .y3w{margin:0!important;padding:0!important}

  /* Data tables: horizontal scroll */
  .tw{max-height:350px;overflow:auto;-webkit-overflow-scrolling:touch}
  table{font-size:11px;min-width:500px}
  table th{font-size:10px;padding:8px 4px;white-space:nowrap}
  table td{padding:6px 4px;font-size:11px}

  /* Recommend box */
  .rc{padding:14px}
  .rc h3{font-size:13px}
  .rc p{font-size:11px;line-height:1.7}

  /* Badges */
  .bg-a,.bg-b,.bg-d{font-size:10px;padding:1px 8px}

  /* Section title */
  .st{font-size:13px;gap:4px}

  /* Compare tab: inputs inside card */
  .cd .g2{gap:10px!important}

  /* Extra pay inputs */
  .ext-inp{font-size:16px!important;padding:12px 10px!important}

  /* Extra pay checkbox labels */
  .cd label[style*="cursor:pointer"]{font-size:11px!important}

  /* Disclaimer */
  .disclaimer p{font-size:10px!important;line-height:1.6!important}
  .disclaimer h4{font-size:11px!important}
}

/* PRINT STYLES */
.btn-print{padding:10px 22px;border:1px solid var(--gld);border-radius:var(--r2);font-family:'IBM Plex Sans Thai',sans-serif;font-size:13px;font-weight:600;cursor:pointer;background:rgba(250,204,21,.08);color:var(--gld);transition:all .2s}
.btn-print:hover{background:rgba(250,204,21,.15);border-color:var(--gld)}



/* PRINT: hide everything, show only #print-area */
.print-info{display:none}
#print-area{display:none}
@media print{
  body>*:not(#print-area){display:none!important}
  #print-area{display:block!important;background:#fff!important;color:#1a1a1a!important;font-family:'IBM Plex Sans Thai',sans-serif!important;font-size:9px!important;line-height:1.5!important}
  #print-area *{-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important}
  @page{size:A4 portrait;margin:8mm}
}
</style>
</head>
<body>
<div class="hdr">
  <h1>üè† <span>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô</span></h1>
  <div class="sub">Home Loan Calculator v1.0.2 &nbsp;|&nbsp; MRR = 6.68% &nbsp;|&nbsp; Cushion Rate = 0.25%</div>
</div>
<div class="tabs">
  <button class="tab on" onclick="sw('calc',this)">üìä ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î</button>
  <button class="tab" onclick="sw('cmp',this)">‚öñÔ∏è ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</button>
  <button class="tab" onclick="sw('ext',this)">üí∞ ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏∞</button>
</div>

<!-- ============ TAB 1: CALCULATOR ============ -->
<div id="t-calc" class="tc on">
<div class="cd">
  <div class="st">üìù ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ</div>
  <div class="ig">
    <div><label>‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ (‡∏ö‡∏≤‡∏ó)</label><input id="c_l" value="3,000,000" oninput="fn(this)"></div>
    <div><label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ</label><input type="number" id="c_y" value="30" min="1" max="40"></div>
  </div>
  <div style="margin-top:16px">
    <label style="font-size:12px;font-weight:600;color:var(--txt2);display:block;margin-bottom:8px">üè¶ ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ (%)</label>
    <div class="rg">
      <div><div class="rh">‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</div><input id="c_r1" value="2.99"></div>
      <div><div class="rh">‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2</div><input id="c_r2" value="4.40"></div>
      <div><div class="rh">‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3</div><input id="c_r3" value="4.95"></div>
      <div><div class="rh">>= ‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4</div><input id="c_r4" value="6.05"></div>
    </div>
  </div>
  <div class="br">
    <button class="b1" onclick="doCalc()">üìä ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
    <button class="b2" onclick="clr('c')">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤</button>
    <button class="btn-print no-print" onclick="doPrint('calc')">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå</button>
  </div>
</div>
<div id="cr" class="hid"></div>
</div>

<!-- ============ TAB 2: COMPARE ============ -->
<div id="t-cmp" class="tc">
<div class="cd">
  <div class="st">‚öñÔ∏è ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 2 ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠ (A vs B)</div>
  <div class="g2">
    <div class="cd" style="border-color:rgba(34,211,167,.2);margin:0">
      <h3 style="color:var(--grn);font-size:14px;font-weight:700;margin-bottom:12px">üè¶ <span class="bg-a">A</span> ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠ A (‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏≤)</h3>
      <div class="ig">
        <div><label>‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ</label><input id="a_l" value="3,000,000" oninput="fn(this)"></div>
        <div><label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ</label><input type="number" id="a_y" value="30"></div>
        <div><label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö</label><select id="a_t" onchange="togPmt('a')"><option value="flat">‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏á‡∏ó‡∏µ‡πà (Flat)</option><option value="step">‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î (Step)</option></select></div>
      </div>
      <div style="margin-top:12px"><label style="font-size:12px;font-weight:600;color:var(--txt2);display:block;margin-bottom:6px">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ (%)</label>
        <div class="rg"><div><div class="rh">‡∏õ‡∏µ 1</div><input id="a_r1" value="2.99"></div><div><div class="rh">‡∏õ‡∏µ 2</div><input id="a_r2" value="4.40"></div><div><div class="rh">‡∏õ‡∏µ 3</div><input id="a_r3" value="4.95"></div><div><div class="rh">>= ‡∏õ‡∏µ 4</div><input id="a_r4" value="6.05"></div></div>
      </div>
      <div id="a_pmt_area" style="margin-top:10px">
        <div id="a_fd"><label style="font-size:11px;color:var(--mut)">‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (Optional, 0 = ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</label><div class="rg" style="grid-template-columns:1fr;margin-top:4px;max-width:220px"><div><div class="rh">‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î</div><input id="a_fp" value="0" oninput="fn(this)"></div></div></div>
        <div id="a_sd" class="hid"><label style="font-size:11px;color:var(--mut)">‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏õ‡∏µ 1-3 (Optional, 0 = ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</label><div class="rg" style="grid-template-columns:repeat(3,1fr);margin-top:4px"><div><div class="rh">‡∏õ‡∏µ 1</div><input id="a_p1" value="0" oninput="fn(this)"></div><div><div class="rh">‡∏õ‡∏µ 2</div><input id="a_p2" value="0" oninput="fn(this)"></div><div><div class="rh">‡∏õ‡∏µ 3</div><input id="a_p3" value="0" oninput="fn(this)"></div></div></div>
      </div>
    </div>
    <div class="cd" style="border-color:rgba(56,189,248,.2);margin:0">
      <h3 style="color:var(--blu);font-size:14px;font-weight:700;margin-bottom:12px">üèõÔ∏è <span class="bg-b">B</span> ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠ B (‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á)</h3>
      <div class="ig">
        <div><label>‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ</label><input id="b_l" value="3,000,000" oninput="fn(this)"></div>
        <div><label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ</label><input type="number" id="b_y" value="30"></div>
        <div><label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö</label><select id="b_t" onchange="togPmt('b')"><option value="flat">‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏á‡∏ó‡∏µ‡πà (Flat)</option><option value="step">‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î (Step)</option></select></div>
      </div>
      <div style="margin-top:12px"><label style="font-size:12px;font-weight:600;color:var(--txt2);display:block;margin-bottom:6px">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ (%)</label>
        <div class="rg"><div><div class="rh">‡∏õ‡∏µ 1</div><input id="b_r1" value="2.59"></div><div><div class="rh">‡∏õ‡∏µ 2</div><input id="b_r2" value="4.50"></div><div><div class="rh">‡∏õ‡∏µ 3</div><input id="b_r3" value="5.20"></div><div><div class="rh">>= ‡∏õ‡∏µ 4</div><input id="b_r4" value="6.15"></div></div>
      </div>
      <div id="b_pmt_area" style="margin-top:10px">
        <div id="b_fd"><label style="font-size:11px;color:var(--mut)">‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (Optional, 0 = ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</label><div class="rg" style="grid-template-columns:1fr;margin-top:4px;max-width:220px"><div><div class="rh">‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î</div><input id="b_fp" value="0" oninput="fn(this)"></div></div></div>
        <div id="b_sd" class="hid"><label style="font-size:11px;color:var(--mut)">‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏õ‡∏µ 1-3 (Optional, 0 = ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</label><div class="rg" style="grid-template-columns:repeat(3,1fr);margin-top:4px"><div><div class="rh">‡∏õ‡∏µ 1</div><input id="b_p1" value="0" oninput="fn(this)"></div><div><div class="rh">‡∏õ‡∏µ 2</div><input id="b_p2" value="0" oninput="fn(this)"></div><div><div class="rh">‡∏õ‡∏µ 3</div><input id="b_p3" value="0" oninput="fn(this)"></div></div></div>
      </div>
    </div>
  </div>
  <div class="br">
    <button class="b1" onclick="doCmp()">‚öñÔ∏è ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</button>
    <button class="b2" onclick="clr('m')">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤</button>
    <button class="btn-print no-print" onclick="doPrint('cmp')">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå</button>
  </div>
</div>
<div id="mr" class="hid"></div>
</div>

<!-- ============ TAB 3: EXTRA PAY ============ -->
<div id="t-ext" class="tc">
<div class="cd">
  <div class="st">üí∞ ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏∞‡∏´‡∏ô‡∏µ‡πâ</div>
  <div class="ig">
    <div><label>‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ (‡∏ö‡∏≤‡∏ó)</label><input id="e_l" value="3,000,000" oninput="fn(this)"></div>
    <div><label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ</label><input type="number" id="e_y" value="30"></div>
  </div>
  <div style="margin-top:16px"><label style="font-size:12px;font-weight:600;color:var(--txt2);display:block;margin-bottom:8px">üè¶ ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ (%)</label>
    <div class="rg"><div><div class="rh">‡∏õ‡∏µ 1</div><input id="e_r1" value="2.99"></div><div><div class="rh">‡∏õ‡∏µ 2</div><input id="e_r2" value="4.40"></div><div><div class="rh">‡∏õ‡∏µ 3</div><input id="e_r3" value="4.95"></div><div><div class="rh">>= ‡∏õ‡∏µ 4</div><input id="e_r4" value="6.05"></div></div>
  </div>
  <div style="margin-top:16px" class="g2">
    <div><label style="font-size:12px;font-weight:600;color:var(--txt2);display:block;margin-bottom:4px">üíµ ‡πÇ‡∏õ‡∏∞‡∏£‡∏≤‡∏¢‡∏õ‡∏µ (‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ)</label><input id="e_ey" value="100,000" oninput="fn(this)" class="ext-inp"><label style="font-size:11px;color:var(--txt2);cursor:pointer;display:flex;align-items:center;gap:5px;margin-top:6px"><input type="checkbox" id="e_yr2y" checked style="accent-color:var(--gld);width:15px;height:15px"> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏∞‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2 (‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 24)</label></div>
    <div><label style="font-size:12px;font-weight:600;color:var(--txt2);display:block;margin-bottom:4px">üíµ ‡πÇ‡∏õ‡∏∞‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</label><input id="e_em" value="5,000" oninput="fn(this)" class="ext-inp"><label style="font-size:11px;color:var(--txt2);cursor:pointer;display:flex;align-items:center;gap:5px;margin-top:6px"><input type="checkbox" id="e_yr2m" checked style="accent-color:var(--grn);width:15px;height:15px"> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏∞‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2 (‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà 13)</label></div>
  </div>

  <div class="br">
    <button class="b1" onclick="doExt()">üí∞ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
    <button class="b2" onclick="clr('e')">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤</button>
    <button class="btn-print no-print" onclick="doPrint('ext')">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå</button>
  </div>
</div>
<div id="er" class="hid"></div>
</div>

<script>
const CSH=.0025;
function pn(v){return parseFloat(String(v).replace(/,/g,''))||0}
function fm(n){return Math.round(n).toLocaleString('en-US')}
function fp(n){return(n*100).toFixed(2)+'%'}
function fn(e){let v=e.value.replace(/,/g,'').replace(/[^\d.]/g,'');if(!v)return;let p=v.split('.');p[0]=parseInt(p[0]||0).toLocaleString('en-US');e.value=p.join('.')}
function sw(t,el){document.querySelectorAll('.tc').forEach(x=>x.classList.remove('on'));document.querySelectorAll('.tab').forEach(x=>x.classList.remove('on'));document.getElementById('t-'+t).classList.add('on');el.classList.add('on')}
function PMT(r,n,pv){if(r===0)return-pv/n;let x=Math.pow(1+r,n);return(r*pv*x)/(x-1)}
function rup(n){return Math.ceil(n/100)*100}
function gr(m,r1,r2,r3,r4){return m<=12?r1:m<=24?r2:m<=36?r3:r4}
function pt(m){return Math.floor(m/12)+' ‡∏õ‡∏µ '+(m%12)+' ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'}

// Build summary panel row
function sr(lbl,val,cls){return`<div class="sum-row"><span class="lbl">${lbl}</span><span class="val ${cls||''}">${val}</span></div>`}

function amor(P,N,R,mode,mp,flatPmt){
  let[r1,r2,r3,r4]=R,inst=[];
  if(mode==='flat'){let p=flatPmt&&flatPmt>0?flatPmt:rup(PMT((r4+CSH)/12,N,P));inst=[p,p,p,p]}
  else{let p1=rup(PMT((r1+CSH)/12,N,P)),p2=rup(PMT((r2+CSH)/12,N,P)),p3=rup(PMT((r3+CSH)/12,N,P)),p4=rup(PMT((r4+CSH)/12,N,P));
  if(mp&&mp[0]>0)p1=mp[0];if(mp&&mp[1]>0)p2=mp[1];if(mp&&mp[2]>0)p3=mp[2];inst=[p1,p2,p3,p4]}
  let s=[],b=P,bp=inst[3];
  for(let m=1;m<=N+120;m++){if(b<=.5)break;let y=Math.ceil(m/12),r=gr(m,r1,r2,r3,r4),i=b*(r/12);
  let p=mode==='flat'?bp:m<=12?inst[0]:m<=24?inst[1]:m<=36?inst[2]:inst[3];
  if(b<p)p=b+i;let pr=p-i;if(pr<0)pr=0;b-=pr;if(b<.5)b=0;
  s.push({m,y,r,pmt:p,int:i,prn:pr,bal:b})}
  return{s,inst}
}

function amorX(P,N,R,ey,em,yr2y,yr2m){
  let[r1,r2,r3,r4]=R,bp=rup(PMT((r4+CSH)/12,N,P)),s=[],b=P;
  let emStart=yr2m?13:1,eyStart=yr2y?24:12;
  for(let m=1;m<=N+300;m++){if(b<=.5)break;let y=Math.ceil(m/12),r=gr(m,r1,r2,r3,r4),i=b*(r/12);
  let p=bp,ex=0;if(em>0&&m>=emStart)ex+=em;if(ey>0&&m>=eyStart&&m%12===0)ex+=ey;p+=ex;
  if(b+i<p)p=b+i;let pr=p-i;if(pr<0)pr=0;b-=pr;if(b<.5)b=0;
  s.push({m,y,r,pmt:p,int:i,prn:pr,bal:b,ex})}
  return{s,bp}
}

function byYr(s){let y={};for(let r of s){if(!y[r.y])y[r.y]={p:0,i:0,pr:0,b:0,r:r.r};y[r.y].p+=r.pmt;y[r.y].i+=r.int;y[r.y].pr+=r.prn;y[r.y].b=r.bal}return y}
function tI(s){return s.reduce((a,r)=>a+r.int,0)}
function i3(s){return s.filter(r=>r.m<=36).reduce((a,r)=>a+r.int,0)}
function p3(s){return s.filter(r=>r.m<=36).reduce((a,r)=>a+r.prn,0)}
function pm(s){return s.length}

function xlRATE(nper,pmt,pv,fv){let r=.003;for(let i=0;i<500;i++){let xi=Math.pow(1+r,-nper);let f=pv+pmt*(1-xi)/r+fv*xi;let dxi=-nper*Math.pow(1+r,-nper-1);let df=pmt*(nper*xi/(r*(1+r))-(1-xi)/(r*r))+fv*dxi;if(Math.abs(df)<1e-15)break;let nr=r-f/df;if(Math.abs(nr-r)<1e-12)break;r=nr}return r}
function irr(cf){let g=.005;for(let i=0;i<200;i++){let n=0,d=0;for(let j=0;j<cf.length;j++){n+=cf[j]/Math.pow(1+g,j);d-=j*cf[j]/Math.pow(1+g,j+1)}let ng=g-n/d;if(Math.abs(ng-g)<1e-10)return ng;g=ng;if(isNaN(g)||!isFinite(g))return 0}return g}
function eir3(s){if(s.length<2)return 0;let P=s[0].bal+s[0].prn;let bp=s[0].pmt;let rem=s[Math.min(35,s.length-1)].bal;return xlRATE(Math.min(36,s.length),-bp,P,-rem)*12}
function eir4(s){if(s.length<2)return 0;let P=s[0].bal+s[0].prn;let bp=s[0].pmt;let rem=s[Math.min(47,s.length-1)].bal;return xlRATE(Math.min(48,s.length),-bp,P,-rem)*12}
function eirF(s){if(s.length<2)return 0;let P=s[0].bal+s[0].prn,cf=[-P];for(let r of s)cf.push(r.pmt);return irr(cf)*12}

function ytb(yd){let h='';let ks=Object.keys(yd).map(Number).sort((a,b)=>a-b);for(let y of ks){let d=yd[y];if(d.i===0&&d.pr===0)continue;h+=`<tr><td>${y}</td><td>${(d.r*100).toFixed(2)}%</td><td>${fm(d.p)}</td><td>${fm(d.i)}</td><td>${fm(d.pr)}</td><td>${fm(Math.max(0,d.b))}</td></tr>`}return h}

// Mini 3-year summary table for inside summary panels
function y3tb(yd){
  let ths='padding:2px 3px;text-align:right;font-size:8px;color:var(--mut);font-weight:600;border-bottom:1px solid var(--brd);white-space:nowrap';
  let tds='padding:2px 3px;text-align:right;border-bottom:1px solid rgba(30,41,59,.4);color:var(--txt2);font-size:8px;white-space:nowrap';
  let h='<div class="y3w"><table class="y3t"><thead><tr style="background:rgba(255,255,255,.03)"><th style="'+ths+';text-align:center;width:8%">‡∏õ‡∏µ</th><th style="'+ths+';width:18%">‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th style="'+ths+';width:24%">‡∏ï‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th style="'+ths+';width:24%">‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô</th><th style="'+ths+';width:26%">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th></tr></thead><tbody>';
  for(let y=1;y<=3;y++){
    let d=yd[y];
    if(!d) continue;
    h+='<tr><td style="'+tds+';text-align:center">'+y+'</td><td style="'+tds+'">'+(d.r*100).toFixed(2)+'%</td><td style="'+tds+'">'+fm(d.i)+'</td><td style="'+tds+'">'+fm(d.pr)+'</td><td style="'+tds+'">'+fm(Math.max(0,d.b))+'</td></tr>';
  }
  h+='</tbody></table></div>';
  return h;
}

// Diff 3-year table (B-A) for compare diff panel
function y3df(aYd,bYd){
  let ths='padding:2px 3px;text-align:right;font-size:8px;color:var(--mut);font-weight:600;border-bottom:1px solid var(--brd);white-space:nowrap';
  let h='<div class="y3w"><table class="y3t"><thead><tr style="background:rgba(255,255,255,.03)"><th style="'+ths+';text-align:center;width:8%">‡∏õ‡∏µ</th><th style="'+ths+';width:18%">‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th style="'+ths+';width:24%">‡∏ï‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th style="'+ths+';width:24%">‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô</th><th style="'+ths+';width:26%">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th></tr></thead><tbody>';
  for(let y=1;y<=3;y++){
    let a=aYd[y],b=bYd[y];
    if(!a||!b) continue;
    let di=b.i-a.i,dp=b.pr-a.pr,db=b.b-a.b,dr=b.r-a.r;
    let tds='padding:2px 3px;text-align:right;border-bottom:1px solid rgba(30,41,59,.4);font-size:8px;white-space:nowrap';
    let cc=function(v){return v>0?'color:var(--grn)':v<0?'color:var(--pnk)':'color:var(--txt2)'};
    h+='<tr><td style="'+tds+';text-align:center;color:var(--txt2)">'+y+'</td>';
    h+='<td style="'+tds+';'+cc(dr)+'">'+(dr>=0?'+':'')+(dr*100).toFixed(2)+'%</td>';
    h+='<td style="'+tds+';'+cc(-di)+'">'+fm(di)+'</td>';
    h+='<td style="'+tds+';'+cc(dp)+'">'+fm(dp)+'</td>';
    h+='<td style="'+tds+';'+cc(-db)+'">'+fm(db)+'</td></tr>';
  }
  h+='</tbody></table></div>';
  return h;
}

function clr(t){
  if(t==='c'){['c_l','c_y','c_r1','c_r2','c_r3','c_r4'].forEach(i=>document.getElementById(i).value='');document.getElementById('cr').classList.add('hid');document.getElementById('cr').innerHTML=''}
  if(t==='m'){['a_l','a_y','a_r1','a_r2','a_r3','a_r4','b_l','b_y','b_r1','b_r2','b_r3','b_r4','a_p1','a_p2','a_p3','b_p1','b_p2','b_p3','a_fp','b_fp'].forEach(i=>document.getElementById(i).value='');document.getElementById('a_t').value='flat';document.getElementById('b_t').value='flat';document.getElementById('a_fd').classList.remove('hid');document.getElementById('a_sd').classList.add('hid');document.getElementById('b_fd').classList.remove('hid');document.getElementById('b_sd').classList.add('hid');document.getElementById('mr').classList.add('hid');document.getElementById('mr').innerHTML=''}
  if(t==='e'){['e_l','e_y','e_r1','e_r2','e_r3','e_r4','e_ey','e_em'].forEach(i=>document.getElementById(i).value='');document.getElementById('e_yr2y').checked=true;document.getElementById('e_yr2m').checked=true;document.getElementById('er').classList.add('hid');document.getElementById('er').innerHTML=''}
}

// ====== TAB 1: CALC ======
function doCalc(){
  let L=pn(document.getElementById('c_l').value),Y=pn(document.getElementById('c_y').value);
  let R=[pn(document.getElementById('c_r1').value)/100,pn(document.getElementById('c_r2').value)/100,pn(document.getElementById('c_r3').value)/100,pn(document.getElementById('c_r4').value)/100];
  if(!vld(['c_l','c_y','c_r1','c_r2','c_r3','c_r4'],['‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4']))return;
  let N=Y*12,fl=amor(L,N,R,'flat',null),st=amor(L,N,R,'step',null);
  let fS=fl.s,sS=st.s,fY=byYr(fS),sY=byYr(sS);
  let fTI=tI(fS),sTI=tI(sS),fI3=i3(fS),sI3=i3(sS),fP3=p3(fS),sP3=p3(sS);
  let fM=pm(fS),sM=pm(sS),fE3=eir3(fS),sE3=eir3(sS),fE4=eir4(fS),sE4=eir4(sS),fE=eirF(fS),sE=eirF(sS);
  let fAvg3=(R[0]+R[1]+R[2])/3,sAvg3=fAvg3;

  // Recommendation from Recc Calculator sheet logic
  // Compare Flat(A) vs Step(B): EIR, interest, principal, installment, months
  let rFacts=[];
  // EIR 3yr comparison
  if(fE3<sE3) rFacts.push('EIR 3 ‡∏õ‡∏µ ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+fp(Math.abs(sE3-fE3)));
  else if(fE3>sE3) rFacts.push('EIR 3 ‡∏õ‡∏µ ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+fp(Math.abs(fE3-sE3)));
  else rFacts.push('EIR 3 ‡∏õ‡∏µ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  // Interest 3yr
  if(fI3<sI3) rFacts.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ 3 ‡∏õ‡∏µ ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ '+fm(sI3-fI3)+' ‡∏ö‡∏≤‡∏ó');
  else if(fI3>sI3) rFacts.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ 3 ‡∏õ‡∏µ ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+fm(fI3-sI3)+' ‡∏ö‡∏≤‡∏ó');
  else rFacts.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ 3 ‡∏õ‡∏µ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  // Principal 3yr
  if(fP3>sP3) rFacts.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î 3 ‡∏õ‡∏µ ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ '+fm(fP3-sP3)+' ‡∏ö‡∏≤‡∏ó');
  else if(fP3<sP3) rFacts.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î 3 ‡∏õ‡∏µ ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+fm(sP3-fP3)+' ‡∏ö‡∏≤‡∏ó');
  else rFacts.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î 3 ‡∏õ‡∏µ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  let sum3line='‡∏™‡∏£‡∏∏‡∏õ 3 ‡∏õ‡∏µ: '+rFacts.join(', ');

  let rFull=[];
  // EIR full
  if(fE<sE) rFull.push('‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤ ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ '+fp(Math.abs(sE-fE)));
  else if(fE>sE) rFull.push('‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤ ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+fp(Math.abs(fE-sE)));
  else rFull.push('‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  // Installment yr1
  let fPm1=fl.inst[3],sPm1=st.inst[0];
  if(sPm1>fPm1) rFull.push('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏õ‡∏µ‡πÅ‡∏£‡∏Å ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ '+fm(sPm1-fPm1)+' ‡∏ö‡∏≤‡∏ó');
  else if(sPm1<fPm1) rFull.push('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏õ‡∏µ‡πÅ‡∏£‡∏Å ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ '+fm(fPm1-sPm1)+' ‡∏ö‡∏≤‡∏ó');
  else rFull.push('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏õ‡∏µ‡πÅ‡∏£‡∏Å ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  // Months
  if(sM>fM) rFull.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≠‡∏ô ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+pt(Math.abs(sM-fM)));
  else if(sM<fM) rFull.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≠‡∏ô ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ '+pt(Math.abs(fM-sM)));
  else rFull.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≠‡∏ô ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  let sumFullLine='‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤: '+rFull.join(', ');

  // Recommendation (from Recc Calculator scenarios)
  let reccText='';
  if(fE3<sE3) reccText='‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ú‡πà‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏£‡∏Å‡∏à‡∏∞‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏†‡∏≤‡∏£‡∏∞‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á 1-3 ‡∏õ‡∏µ‡πÅ‡∏£‡∏Å ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡∏Å‡∏π‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ú‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏á‡∏ß‡∏î‡∏à‡∏∞‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤';
  else if(fE3>sE3) reccText='‡∏ñ‡∏∂‡∏á‡πÅ‡∏°‡πâ‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ô‡∏µ‡πâ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î‡∏à‡∏∞‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡πÅ‡∏ö‡∏ö‡∏ú‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏á‡∏ß‡∏î‡∏Å‡πá‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ‡πÉ‡∏ô‡πÅ‡∏á‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢ ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î‡∏à‡∏∂‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÉ‡∏´‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏£‡∏Å‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏Å‡∏ß‡πà‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß';
  else reccText='‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ô‡∏µ‡πâ ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏à‡∏∂‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡∏´‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡∏Å‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 1 ‡πÅ‡∏ï‡πà‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏™‡∏π‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÅ‡∏£‡∏Å ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 2 ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤';

  let h=`
  <div class="print-info">
    <div class="pi-title">üè† <span>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô</span></div>
    <div class="pi-sub">Home Loan Calculator v1.0.2 | MRR = 6.68% | Cushion Rate = 0.25% | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${new Date().toLocaleDateString('th-TH')}</div>
    <div class="pi-bar"><span>‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ: <b>${fm(L)} ‡∏ö‡∏≤‡∏ó</b></span><span>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤: <b>${Y} ‡∏õ‡∏µ</b></span><span>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢: <b>${(R[0]*100).toFixed(2)}% / ${(R[1]*100).toFixed(2)}% / ${(R[2]*100).toFixed(2)}% / ${(R[3]*100).toFixed(2)}%</b> (‡∏õ‡∏µ 1/2/3/4+)</span></div>
  </div>
  <div class="rc">
    <h3>üí° ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡∏°‡∏Ç‡∏≤‡∏¢</h3>
    <p><span class="bullet">‚Ä¢</span> ${sum3line}</p>
    <p><span class="bullet">‚Ä¢</span> ${sumFullLine}</p>
    <p style="margin-top:8px"><span class="bullet">‚Ä¢</span> <span class="hl">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</span> ${reccText}</p>
  </div>

  <div class="st" style="margin-top:20px">üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ <span style="font-size:11px;color:var(--mut);margin-left:auto;font-weight:400">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏ì ${new Date().toLocaleDateString('th-TH')}</span></div>
  <div class="g2">
    <div class="sum-panel">
      <div class="panel-hdr flat">üìó ‡πÅ‡∏ö‡∏ö 1: ‡∏ú‡πà‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏á‡∏ß‡∏î (Flat Rate)</div>
      ${sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',fm(fl.inst[3])+' ‡∏ö‡∏≤‡∏ó','grn')}
      ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á',pt(fM))}
      ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 3 ‡∏õ‡∏µ',fp(fAvg3))}
      ${sr('EIR 3 ‡∏õ‡∏µ',fp(fE3))}
      ${sr('EIR 4 ‡∏õ‡∏µ',fp(fE4))}
      ${sr('EIR ‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fp(fE))}
      ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° 3 ‡∏õ‡∏µ',fm(fI3)+' ‡∏ö‡∏≤‡∏ó')}
      ${sr('‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î 3 ‡∏õ‡∏µ',fm(fP3)+' ‡∏ö‡∏≤‡∏ó')}
      ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fm(fTI)+' ‡∏ö‡∏≤‡∏ó','grn')}
      <div style="padding:0 12px 8px">${y3tb(fY)}</div>
    </div>
    <div class="sum-panel">
      <div class="panel-hdr step">üìò ‡πÅ‡∏ö‡∏ö 2: ‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î (Step Rate)</div>
      ${sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô','‡∏õ‡∏µ1: '+fm(st.inst[0])+' / ‡∏õ‡∏µ2: '+fm(st.inst[1])+' / ‡∏õ‡∏µ3: '+fm(st.inst[2])+' / ‡∏õ‡∏µ4: '+fm(st.inst[3]),'blu')}
      ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á',pt(sM))}
      ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 3 ‡∏õ‡∏µ',fp(sAvg3))}
      ${sr('EIR 3 ‡∏õ‡∏µ',fp(sE3))}
      ${sr('EIR 4 ‡∏õ‡∏µ',fp(sE4))}
      ${sr('EIR ‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fp(sE))}
      ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° 3 ‡∏õ‡∏µ',fm(sI3)+' ‡∏ö‡∏≤‡∏ó')}
      ${sr('‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î 3 ‡∏õ‡∏µ',fm(sP3)+' ‡∏ö‡∏≤‡∏ó')}
      ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fm(sTI)+' ‡∏ö‡∏≤‡∏ó','blu')}
      <div style="padding:0 12px 8px">${y3tb(sY)}</div>
    </div>
  </div>

  <div class="st" style="margin-top:20px">üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</div>
  <div class="g2">
    <div><div style="font-size:13px;color:var(--grn);font-weight:700;margin-bottom:6px">üìó ‡πÅ‡∏ö‡∏ö 1: Flat Rate</div><div class="tw"><table><thead><tr><th>‡∏õ‡∏µ</th><th>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th>‡∏¢‡∏≠‡∏î‡∏ú‡πà‡∏≠‡∏ô</th><th>‡∏ï‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th>‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô</th><th>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th></tr></thead><tbody>${ytb(fY)}</tbody></table></div></div>
    <div><div style="font-size:13px;color:var(--blu);font-weight:700;margin-bottom:6px">üìò ‡πÅ‡∏ö‡∏ö 2: Step Rate</div><div class="tw"><table><thead><tr><th>‡∏õ‡∏µ</th><th>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th>‡∏¢‡∏≠‡∏î‡∏ú‡πà‡∏≠‡∏ô</th><th>‡∏ï‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th>‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô</th><th>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th></tr></thead><tbody>${ytb(sY)}</tbody></table></div></div>
  </div>`;
  h+=`<div class="disclaimer" style="background:rgba(100,116,139,.06);border:1px solid var(--brd);border-radius:var(--r);padding:16px 20px;margin-top:20px">
<h4 style="font-size:13px;font-weight:700;color:var(--txt2);margin-bottom:8px">‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏ó‡∏£‡∏≤‡∏ö</h4>
<p style="font-size:12px;color:var(--mut);line-height:1.8;margin:0">- ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏•‡∏á‡∏ô‡∏≤‡∏°‡πÑ‡∏ß‡πâ‡∏Å‡∏±‡∏ö‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£<br>- ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ô‡∏µ‡πâ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô, ‡∏Ñ‡πà‡∏≤‡∏à‡∏î‡∏à‡∏≥‡∏ô‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô<br>- ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà K Contact Center ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 0-2888-8888</p>
</div>`;
  document.getElementById('cr').innerHTML=h;document.getElementById('cr').classList.remove('hid');document.getElementById('cr').scrollIntoView({behavior:'smooth'})
}

// ====== TAB 2: COMPARE ======
function doCmp(){
  let aL=pn(document.getElementById('a_l').value),aY=pn(document.getElementById('a_y').value),aT=document.getElementById('a_t').value;
  let aR=[pn(document.getElementById('a_r1').value)/100,pn(document.getElementById('a_r2').value)/100,pn(document.getElementById('a_r3').value)/100,pn(document.getElementById('a_r4').value)/100];
  let aP=[pn(document.getElementById('a_p1').value),pn(document.getElementById('a_p2').value),pn(document.getElementById('a_p3').value)];
  let bL=pn(document.getElementById('b_l').value),bY=pn(document.getElementById('b_y').value),bT=document.getElementById('b_t').value;
  let bR=[pn(document.getElementById('b_r1').value)/100,pn(document.getElementById('b_r2').value)/100,pn(document.getElementById('b_r3').value)/100,pn(document.getElementById('b_r4').value)/100];
  let bP=[pn(document.getElementById('b_p1').value),pn(document.getElementById('b_p2').value),pn(document.getElementById('b_p3').value)];
  if(!vld(['a_l','a_y','a_r1','a_r2','a_r3','a_r4'],['‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ A','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ A','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ1 A','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ2 A','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ3 A','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ4 A']))return;
  if(!vld(['b_l','b_y','b_r1','b_r2','b_r3','b_r4'],['‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ B','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ B','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ1 B','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ2 B','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ3 B','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ4 B']))return;
  let aFP=pn(document.getElementById('a_fp').value);
  let bFP=pn(document.getElementById('b_fp').value);
  let a=amor(aL,aY*12,aR,aT,aT==='step'?aP:null,aT==='flat'?aFP:null);
  let b=amor(bL,bY*12,bR,bT,bT==='step'?bP:null,bT==='flat'?bFP:null);
  let aS=a.s,bS=b.s,aYr=byYr(aS),bYr=byYr(bS);
  let aTI=tI(aS),bTI=tI(bS),aI3=i3(aS),bI3=i3(bS),aP3=p3(aS),bP3=p3(bS);
  let aM=pm(aS),bM=pm(bS),aE3=eir3(aS),bE3=eir3(bS),aE4=eir4(aS),bE4=eir4(bS),aE=eirF(aS),bE=eirF(bS);
  let aAvg=(aR[0]+aR[1]+aR[2])/3,bAvg=(bR[0]+bR[1]+bR[2])/3;
  let aPm=aS[0]?aS[0].pmt:0,bPm=bS[0]?bS[0].pmt:0;

  // Recc Compare: 9 scenarios from Excel
  let cs='',ad='';
  if(aAvg<bAvg&&aPm<=bPm){cs='‡∏ó‡∏±‡πâ‡∏á‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏Ç‡∏≠‡∏á A ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏∏‡∏Å‡∏°‡∏∏‡∏°';ad='‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏ä‡∏ô‡∏∞‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏Å‡∏°‡∏∏‡∏° ‡πÉ‡∏´‡πâ‡∏û‡∏π‡∏î‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡πà‡∏á‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ'}
  else if(aAvg<bAvg&&aPm===bPm){cs='‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 3‡∏õ‡∏µ A ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏•‡∏∞‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô';ad='‡∏ä‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á (EIR) ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏Å‡πá‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤'}
  else if(aAvg<bAvg&&aPm>bPm){cs='‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 3‡∏õ‡∏µ A ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤';ad='‡∏ä‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á (EIR) ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏≤‡∏Å ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏Å‡πá‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤'}
  else if(aI3===bI3&&aPm<bPm){cs='‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 3‡∏õ‡∏µ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‡πÅ‡∏ï‡πà‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î A ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤';ad='‡∏ä‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á (EIR) ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô'}
  else if(aI3===bI3&&aPm===bPm){cs='‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 3‡∏õ‡∏µ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô';ad='‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Mobile App K+ ‡∏Å‡πà‡∏≠‡∏ô ‡∏ñ‡πâ‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à ‡∏Ñ‡πà‡∏≠‡∏¢‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠ voucher ‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÑ‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô'}
  else if(aI3===bI3&&aPm>bPm){cs='‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 3‡∏õ‡∏µ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î A ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤';ad='‡∏ä‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á (EIR) ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà'}
  else if(aI3>bI3&&aPm<bPm){cs='‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 3‡∏õ‡∏µ A ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤';ad='‡∏ä‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏à‡∏∞‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡∏¢‡∏≠‡∏î‡∏ú‡πà‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏°‡∏µ‡∏†‡∏≤‡∏£‡∏∞‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏î‡∏•‡∏á ‡πÅ‡∏•‡∏∞‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏õ‡∏µ‡∏´‡∏•‡∏±‡∏á‡πÜ ‡∏Å‡πá‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏¢‡∏≠‡∏î‡∏´‡∏ô‡∏µ‡πâ‡∏•‡∏á‡πÑ‡∏î‡πâ‡πÑ‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô'}
  else if(aI3>bI3&&aPm===bPm){cs='‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 3‡∏õ‡∏µ A ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô';ad='‡∏ä‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á (EIR) ‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô ‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ß‡πà‡∏≤‡∏¢‡∏≠‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÅ‡∏û‡πâ‡πÉ‡∏ô 3 ‡∏õ‡∏µ‡πÅ‡∏£‡∏Å ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ä‡πà‡∏ô voucher ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤, compensate ‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≠‡∏°‡∏°‡∏¥‡∏ä‡∏ä‡∏±‡πà‡∏ô ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏Ñ‡∏™‡∏Å‡∏±‡∏ö‡∏ó‡∏≤‡∏á PM'}
  else{cs='‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 3‡∏õ‡∏µ A ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏Å‡πá‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤';ad='‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ñ‡∏™‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏¢‡∏≤‡∏Å ‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ß‡πà‡∏≤‡∏¢‡∏≠‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÅ‡∏û‡πâ‡πÉ‡∏ô 3 ‡∏õ‡∏µ‡πÅ‡∏£‡∏Å ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ä‡πà‡∏ô voucher ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤, compensate ‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≠‡∏°‡∏°‡∏¥‡∏ä‡∏ä‡∏±‡πà‡∏ô ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏Ñ‡∏™‡∏Å‡∏±‡∏ö‡∏ó‡∏≤‡∏á PM'}

  // Recc Compare(facts) summary
  let f3=[];
  if(aAvg<bAvg)f3.push('‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ B ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ '+fp(Math.abs(bAvg-aAvg)));else if(aAvg>bAvg)f3.push('‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ B ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+fp(Math.abs(aAvg-bAvg)));else f3.push('‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  if(aE3<bE3)f3.push('EIR 3 ‡∏õ‡∏µ B ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ '+fp(Math.abs(bE3-aE3)));else if(aE3>bE3)f3.push('EIR 3 ‡∏õ‡∏µ B ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+fp(Math.abs(aE3-bE3)));else f3.push('EIR 3 ‡∏õ‡∏µ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  if(aI3<bI3)f3.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ B ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ '+fm(bI3-aI3)+' ‡∏ö‡∏≤‡∏ó');else if(aI3>bI3)f3.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ B ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+fm(aI3-bI3)+' ‡∏ö‡∏≤‡∏ó');else f3.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  if(aP3>bP3)f3.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î B ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ A '+fm(aP3-bP3)+' ‡∏ö‡∏≤‡∏ó');else if(aP3<bP3)f3.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î B ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ A '+fm(bP3-aP3)+' ‡∏ö‡∏≤‡∏ó');else f3.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');

  let fAll=[];
  if(aE<bE)fAll.push('‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤ B ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ '+fp(Math.abs(bE-aE)));else if(aE>bE)fAll.push('‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤ B ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+fp(Math.abs(aE-bE)));else fAll.push('‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤ ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  if(bPm>aPm)fAll.push('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏õ‡∏µ‡πÅ‡∏£‡∏Å B ‡πÅ‡∏û‡∏á‡∏Å‡∏ß‡πà‡∏≤ A '+fm(bPm-aPm)+' ‡∏ö‡∏≤‡∏ó');else if(bPm<aPm)fAll.push('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏õ‡∏µ‡πÅ‡∏£‡∏Å B ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ A '+fm(aPm-bPm)+' ‡∏ö‡∏≤‡∏ó');else fAll.push('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏õ‡∏µ‡πÅ‡∏£‡∏Å ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');
  if(bM>aM)fAll.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≠‡∏ô B ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ '+pt(Math.abs(bM-aM)));else if(bM<aM)fAll.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≠‡∏ô B ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ '+pt(Math.abs(aM-bM)));else fAll.push('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≠‡∏ô ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô');

  let dM=bM-aM;
  let dfn=(v)=>v>0?'+'+fm(v):v<0?fm(v):'0';

  let h=`<div class="print-info">
    <div class="pi-title">üè† <span>‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô</span></div>
    <div class="pi-sub">Home Loan Calculator v1.0.2 | MRR = 6.68% | Cushion Rate = 0.25% | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${new Date().toLocaleDateString('th-TH')}</div>
    <div class="pi-bar"><span><b>A:</b> ${fm(aL)} ‡∏ö‡∏≤‡∏ó / ${aY} ‡∏õ‡∏µ / ${aT==='flat'?'‡∏Ñ‡∏á‡∏ó‡∏µ‡πà':'‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î'} / ‡∏î‡∏ö. ${(aR[0]*100).toFixed(2)}/${(aR[1]*100).toFixed(2)}/${(aR[2]*100).toFixed(2)}/${(aR[3]*100).toFixed(2)}%</span><span><b>B:</b> ${fm(bL)} ‡∏ö‡∏≤‡∏ó / ${bY} ‡∏õ‡∏µ / ${bT==='flat'?'‡∏Ñ‡∏á‡∏ó‡∏µ‡πà':'‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î'} / ‡∏î‡∏ö. ${(bR[0]*100).toFixed(2)}/${(bR[1]*100).toFixed(2)}/${(bR[2]*100).toFixed(2)}/${(bR[3]*100).toFixed(2)}%</span></div>
  </div>
  <div class="rc"><h3>üí° ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡∏°‡∏Ç‡∏≤‡∏¢</h3>
  <p><span class="bullet">‚Ä¢</span> ‡∏™‡∏£‡∏∏‡∏õ 3 ‡∏õ‡∏µ: ${f3.join(', ')}</p>
  <p><span class="bullet">‚Ä¢</span> ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤: ${fAll.join(', ')}</p>
  <p style="margin-top:8px"><span class="bullet">‚Ä¢</span> <span class="hl">‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏Ñ‡∏™:</span> ${cs}</p>
  <p><span class="bullet">‚Ä¢</span> <span class="hl">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</span> ${ad}</p></div>

  <div class="st" style="margin-top:20px">üìã ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</div>
  <div class="g3">
    <div class="sum-panel"><div class="panel-hdr bank-a">üè¶ <span class="bg-a">A</span>&nbsp; ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠ A ${aT==='flat'?'(‡∏Ñ‡∏á‡∏ó‡∏µ‡πà)':'(‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î)'}</div>
    ${sr('‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ',fm(aL)+' ‡∏ö‡∏≤‡∏ó')}
    ${aT==='flat'?sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',fm(aPm)+' ‡∏ö‡∏≤‡∏ó','grn'):sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î ‡∏õ‡∏µ1/2/3/4+',fm(a.inst[0])+' / '+fm(a.inst[1])+' / '+fm(a.inst[2])+' / '+fm(a.inst[3])+' ‡∏ö‡∏≤‡∏ó','grn')}
    ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á',pt(aM))}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 3 ‡∏õ‡∏µ',fp(aAvg))}
    ${sr('EIR 3 ‡∏õ‡∏µ',fp(aE3))}
    ${sr('EIR 4 ‡∏õ‡∏µ',fp(aE4))}
    ${sr('EIR ‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fp(aE))}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° 3 ‡∏õ‡∏µ',fm(aI3)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î 3 ‡∏õ‡∏µ',fm(aP3)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fm(aTI)+' ‡∏ö‡∏≤‡∏ó','grn')}
    <div style="padding:0 12px 8px">${y3tb(aYr)}</div></div>
    <div class="sum-panel"><div class="panel-hdr bank-b">üèõÔ∏è <span class="bg-b">B</span>&nbsp; ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠ B ${bT==='flat'?'(‡∏Ñ‡∏á‡∏ó‡∏µ‡πà)':'(‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î)'}</div>
    ${sr('‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ',fm(bL)+' ‡∏ö‡∏≤‡∏ó')}
    ${bT==='flat'?sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',fm(bPm)+' ‡∏ö‡∏≤‡∏ó','blu'):sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î ‡∏õ‡∏µ1/2/3/4+',fm(b.inst[0])+' / '+fm(b.inst[1])+' / '+fm(b.inst[2])+' / '+fm(b.inst[3])+' ‡∏ö‡∏≤‡∏ó','blu')}
    ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á',pt(bM))}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 3 ‡∏õ‡∏µ',fp(bAvg))}
    ${sr('EIR 3 ‡∏õ‡∏µ',fp(bE3))}
    ${sr('EIR 4 ‡∏õ‡∏µ',fp(bE4))}
    ${sr('EIR ‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fp(bE))}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° 3 ‡∏õ‡∏µ',fm(bI3)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î 3 ‡∏õ‡∏µ',fm(bP3)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fm(bTI)+' ‡∏ö‡∏≤‡∏ó','blu')}
    <div style="padding:0 12px 8px">${y3tb(bYr)}</div></div>
    <div class="sum-panel"><div class="panel-hdr diff">üìä <span class="bg-d">Diff</span>&nbsp; (B ‚àí A)</div>
    ${sr('‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ',fm(bL-aL)+' ‡∏ö‡∏≤‡∏ó')}
    ${(function(){let aI=a.inst,bI=b.inst;let d=[];for(let i=0;i<4;i++){let av=aT==='flat'?aI[0]:aI[i];let bv=bT==='flat'?bI[0]:bI[i];d.push(bv-av)}if(d[0]===d[1]&&d[1]===d[2]&&d[2]===d[3])return sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',fm(d[0])+' ‡∏ö‡∏≤‡∏ó',d[0]>0?'pos':d[0]<0?'neg':'');return sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î ‡∏õ‡∏µ1/2/3/4+',fm(d[0])+' / '+fm(d[1])+' / '+fm(d[2])+' / '+fm(d[3])+' ‡∏ö‡∏≤‡∏ó',d[0]>0?'pos':d[0]<0?'neg':'')})()}
    ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á',(dM>0?'+':dM<0?'':'')+pt(Math.abs(dM)),dM>0?'neg':'pos')}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 3 ‡∏õ‡∏µ',fp(bAvg-aAvg),bAvg-aAvg>0?'pos':'neg')}
    ${sr('EIR 3 ‡∏õ‡∏µ',fp(bE3-aE3),bE3-aE3>0?'pos':'neg')}
    ${sr('EIR 4 ‡∏õ‡∏µ',fp(bE4-aE4),bE4-aE4>0?'pos':'neg')}
    ${sr('EIR ‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fp(bE-aE),bE-aE>0?'pos':'neg')}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° 3 ‡∏õ‡∏µ',fm(bI3-aI3)+' ‡∏ö‡∏≤‡∏ó',bI3-aI3>0?'pos':'neg')}
    ${sr('‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î 3 ‡∏õ‡∏µ',fm(bP3-aP3)+' ‡∏ö‡∏≤‡∏ó',bP3-aP3>0?'pos':'neg')}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fm(bTI-aTI)+' ‡∏ö‡∏≤‡∏ó',bTI-aTI>0?'pos':'neg')}
    <div style="padding:0 12px 8px">${y3df(aYr,bYr)}</div></div>
  </div>

  <div class="st" style="margin-top:20px">üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</div>
  <div class="g2">
    <div><div style="font-size:13px;color:var(--grn);font-weight:700;margin-bottom:6px">üè¶ <span class="bg-a">A</span></div><div class="tw" style="max-height:380px"><table><thead><tr><th>‡∏õ‡∏µ</th><th>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th>‡∏¢‡∏≠‡∏î‡∏ú‡πà‡∏≠‡∏ô</th><th>‡∏ï‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th>‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô</th><th>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th></tr></thead><tbody>${ytb(aYr)}</tbody></table></div></div>
    <div><div style="font-size:13px;color:var(--blu);font-weight:700;margin-bottom:6px">üèõÔ∏è <span class="bg-b">B</span></div><div class="tw" style="max-height:380px"><table><thead><tr><th>‡∏õ‡∏µ</th><th>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th>‡∏¢‡∏≠‡∏î‡∏ú‡πà‡∏≠‡∏ô</th><th>‡∏ï‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th><th>‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô</th><th>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th></tr></thead><tbody>${ytb(bYr)}</tbody></table></div></div>
  </div>`;
  h+=`<div class="disclaimer" style="background:rgba(100,116,139,.06);border:1px solid var(--brd);border-radius:var(--r);padding:16px 20px;margin-top:20px">
<h4 style="font-size:13px;font-weight:700;color:var(--txt2);margin-bottom:8px">‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏ó‡∏£‡∏≤‡∏ö</h4>
<p style="font-size:12px;color:var(--mut);line-height:1.8;margin:0">- ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏•‡∏á‡∏ô‡∏≤‡∏°‡πÑ‡∏ß‡πâ‡∏Å‡∏±‡∏ö‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£<br>- ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ô‡∏µ‡πâ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô, ‡∏Ñ‡πà‡∏≤‡∏à‡∏î‡∏à‡∏≥‡∏ô‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô<br>- ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà K Contact Center ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 0-2888-8888</p>
</div>`;
  document.getElementById('mr').innerHTML=h;document.getElementById('mr').classList.remove('hid');document.getElementById('mr').scrollIntoView({behavior:'smooth'})
}

// ====== TAB 3: EXTRA PAY ======
function doExt(){
  let L=pn(document.getElementById('e_l').value),Y=pn(document.getElementById('e_y').value);
  let R=[pn(document.getElementById('e_r1').value)/100,pn(document.getElementById('e_r2').value)/100,pn(document.getElementById('e_r3').value)/100,pn(document.getElementById('e_r4').value)/100];
  let ey=pn(document.getElementById('e_ey').value),em=pn(document.getElementById('e_em').value);
  let yr2y=document.getElementById('e_yr2y').checked;
  let yr2m=document.getElementById('e_yr2m').checked;
  if(!vld(['e_l','e_y','e_r1','e_r2','e_r3','e_r4'],['‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3','‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4']))return;
  let N=Y*12;
  let n=amorX(L,N,R,0,0,false,false),wy=amorX(L,N,R,ey,0,yr2y,false),wm=amorX(L,N,R,0,em,false,yr2m);
  let nS=n.s,yS=wy.s,mS=wm.s;
  let nY=byYr(nS),yY=byYr(yS),mY=byYr(mS);
  let nTI=tI(nS),yTI=tI(yS),mTI=tI(mS),nI3=i3(nS),yI3=i3(yS),mI3=i3(mS);
  let nP3=p3(nS),yP3=p3(yS),mP3=p3(mS),nM=pm(nS),yM=pm(yS),mM=pm(mS);
  let nE3=eir3(nS),nE=eirF(nS),nE4=eir4(nS);
  let yE3=ey>0?eir3(nS):0,mE3=em>0?eir3(nS):0,yE4=ey>0?eir4(nS):0,mE4=em>0?eir4(nS):0;
  if(ey>0){let cf=[-L];for(let r of yS)cf.push(r.pmt);var yEF=irr(cf)*12}else{var yEF=0}
  if(em>0){let cf=[-L];for(let r of mS)cf.push(r.pmt);var mEF=irr(cf)*12}else{var mEF=0}

  // Recommendation from Recc Extrapay sheet
  let ns=`‡πÅ‡∏ú‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡∏õ‡∏Å‡∏ï‡∏¥: ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ú‡πà‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${pt(nM)} ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏†‡∏≤‡∏£‡∏∞‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° ${fm(nTI)} ‡∏ö‡∏≤‡∏ó`;
  let ys='',ms='';
  if(ey>0)ys=`‡∏ú‡∏•‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏∞‡∏£‡∏≤‡∏¢‡∏õ‡∏µ (${fm(ey)} ‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ): ‡πÉ‡∏ô 3 ‡∏õ‡∏µ‡πÅ‡∏£‡∏Å ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÑ‡∏î‡πâ ${fm(nI3-yI3)} ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô ${fm(yP3-nP3)} ‡∏ö‡∏≤‡∏ó. ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß ‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°‡πÑ‡∏î‡πâ ${fm(nTI-yTI)} ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏•‡∏∞‡∏ú‡πà‡∏≠‡∏ô‡∏´‡∏°‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô ${pt(nM-yM)}`;
  if(em>0)ms=`‡∏ú‡∏•‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏∞‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (${fm(em)} ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô): ‡πÉ‡∏ô 3 ‡∏õ‡∏µ‡πÅ‡∏£‡∏Å ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÑ‡∏î‡πâ ${fm(nI3-mI3)} ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô ${fm(mP3-nP3)} ‡∏ö‡∏≤‡∏ó. ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß ‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°‡πÑ‡∏î‡πâ ${fm(nTI-mTI)} ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏•‡∏∞‡∏ú‡πà‡∏≠‡∏ô‡∏´‡∏°‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô ${pt(nM-mM)}`;

  let h=`<div class="print-info">
    <div class="pi-title">üè† <span>‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô</span></div>
    <div class="pi-sub">Home Loan Calculator v1.0.2 | MRR = 6.68% | Cushion Rate = 0.25% | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${new Date().toLocaleDateString('th-TH')}</div>
    <div class="pi-bar"><span>‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ: <b>${fm(L)} ‡∏ö‡∏≤‡∏ó</b></span><span>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤: <b>${Y} ‡∏õ‡∏µ</b></span><span>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢: <b>${(R[0]*100).toFixed(2)}/${(R[1]*100).toFixed(2)}/${(R[2]*100).toFixed(2)}/${(R[3]*100).toFixed(2)}%</b></span>${ey>0?'<span>‡πÇ‡∏õ‡∏∞‡∏£‡∏≤‡∏¢‡∏õ‡∏µ: <b>'+fm(ey)+' ‡∏ö‡∏≤‡∏ó</b></span>':''}${em>0?'<span>‡πÇ‡∏õ‡∏∞‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: <b>'+fm(em)+' ‡∏ö‡∏≤‡∏ó</b></span>':''}</div>
  </div>
  <div class="rc"><h3>üí° ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡∏°‡∏Ç‡∏≤‡∏¢</h3>
  <p><span class="bullet">‚Ä¢</span> ${ns}</p>
  ${ys?'<p><span class="bullet">‚Ä¢</span> '+ys+'</p>':''}
  ${ms?'<p><span class="bullet">‚Ä¢</span> '+ms+'</p>':''}</div>

  <div class="st" style="margin-top:20px">üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</div>
  <div class="g3">
    <div class="sum-panel"><div class="panel-hdr normal">üìÑ ‡∏ú‡πà‡∏≠‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</div>
    ${sr('‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ',fm(L)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ',Y+' ‡∏õ‡∏µ')}
    ${sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',fm(n.bp)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á',pt(nM))}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 3 ‡∏õ‡∏µ',fp((R[0]+R[1]+R[2])/3))}
    ${sr('EIR 3 ‡∏õ‡∏µ',fp(nE3))}
    ${sr('EIR 4 ‡∏õ‡∏µ',fp(nE4))}
    ${sr('EIR ‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fp(nE))}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° 3 ‡∏õ‡∏µ',fm(nI3)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î 3 ‡∏õ‡∏µ',fm(nP3)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fm(nTI)+' ‡∏ö‡∏≤‡∏ó')}
    <div style="padding:0 12px 8px">${y3tb(nY)}</div></div>
    ${ey>0?`<div class="sum-panel"><div class="panel-hdr yearly">üíµ ‡πÇ‡∏õ‡∏∞‡∏£‡∏≤‡∏¢‡∏õ‡∏µ (${fm(ey)}/‡∏õ‡∏µ)</div>
    ${sr('‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ',fm(L)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ',Y+' ‡∏õ‡∏µ')}
    ${sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',fm(n.bp)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á',pt(yM),'grn')}
    ${sr('‚ö° ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô',pt(nM-yM),'grn')}
    ${sr('EIR 3 ‡∏õ‡∏µ',fp(yE3))}
    ${sr('EIR 4 ‡∏õ‡∏µ',fp(yE4))}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° 3 ‡∏õ‡∏µ',fm(yI3)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‚ö° ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 3 ‡∏õ‡∏µ',fm(nI3-yI3)+' ‡∏ö‡∏≤‡∏ó','grn')}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fm(yTI)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‚ö° ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏£‡∏ß‡∏°',fm(nTI-yTI)+' ‡∏ö‡∏≤‡∏ó','grn')}
    <div style="padding:0 12px 8px">${y3tb(yY)}</div></div>`:'<div></div>'}
    ${em>0?`<div class="sum-panel"><div class="panel-hdr monthly">üíµ ‡πÇ‡∏õ‡∏∞‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (${fm(em)}/‡∏î.)</div>
    ${sr('‡∏¢‡∏≠‡∏î‡∏Å‡∏π‡πâ',fm(L)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ',Y+' ‡∏õ‡∏µ')}
    ${sr('‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',fm(n.bp)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á',pt(mM),'grn')}
    ${sr('‚ö° ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô',pt(nM-mM),'grn')}
    ${sr('EIR 3 ‡∏õ‡∏µ',fp(mE3))}
    ${sr('EIR 4 ‡∏õ‡∏µ',fp(mE4))}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° 3 ‡∏õ‡∏µ',fm(mI3)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‚ö° ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ 3 ‡∏õ‡∏µ',fm(nI3-mI3)+' ‡∏ö‡∏≤‡∏ó','grn')}
    ${sr('‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏°‡∏ï‡∏•‡∏≠‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤',fm(mTI)+' ‡∏ö‡∏≤‡∏ó')}
    ${sr('‚ö° ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏£‡∏ß‡∏°',fm(nTI-mTI)+' ‡∏ö‡∏≤‡∏ó','grn')}
    <div style="padding:0 12px 8px">${y3tb(mY)}</div></div>`:'<div></div>'}
  </div>

  <div class="st" style="margin-top:20px">üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</div>
  <div class="g3">
    <div><div style="font-size:12px;color:var(--txt2);font-weight:700;margin-bottom:4px">üìÑ ‡∏õ‡∏Å‡∏ï‡∏¥</div><div class="tw" style="max-height:380px"><table><thead><tr><th>‡∏õ‡∏µ</th><th>‡∏î‡∏ö.</th><th>‡∏ú‡πà‡∏≠‡∏ô</th><th>‡∏ï‡∏±‡∏î‡∏î‡∏≠‡∏Å</th><th>‡∏ï‡∏±‡∏î‡∏ï‡πâ‡∏ô</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th></tr></thead><tbody>${ytb(nY)}</tbody></table></div></div>
    ${ey>0?`<div><div style="font-size:12px;color:var(--gld);font-weight:700;margin-bottom:4px">üíµ ‡πÇ‡∏õ‡∏∞‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</div><div class="tw" style="max-height:380px"><table><thead><tr><th>‡∏õ‡∏µ</th><th>‡∏î‡∏ö.</th><th>‡∏ú‡πà‡∏≠‡∏ô</th><th>‡∏ï‡∏±‡∏î‡∏î‡∏≠‡∏Å</th><th>‡∏ï‡∏±‡∏î‡∏ï‡πâ‡∏ô</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th></tr></thead><tbody>${ytb(yY)}</tbody></table></div></div>`:'<div></div>'}
    ${em>0?`<div><div style="font-size:12px;color:var(--grn);font-weight:700;margin-bottom:4px">üíµ ‡πÇ‡∏õ‡∏∞‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div><div class="tw" style="max-height:380px"><table><thead><tr><th>‡∏õ‡∏µ</th><th>‡∏î‡∏ö.</th><th>‡∏ú‡πà‡∏≠‡∏ô</th><th>‡∏ï‡∏±‡∏î‡∏î‡∏≠‡∏Å</th><th>‡∏ï‡∏±‡∏î‡∏ï‡πâ‡∏ô</th><th>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th></tr></thead><tbody>${ytb(mY)}</tbody></table></div></div>`:'<div></div>'}
  </div>`;
  h+=`<div class="disclaimer" style="background:rgba(100,116,139,.06);border:1px solid var(--brd);border-radius:var(--r);padding:16px 20px;margin-top:20px">
<h4 style="font-size:13px;font-weight:700;color:var(--txt2);margin-bottom:8px">‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏ó‡∏£‡∏≤‡∏ö</h4>
<p style="font-size:12px;color:var(--mut);line-height:1.8;margin:0">- ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏•‡∏á‡∏ô‡∏≤‡∏°‡πÑ‡∏ß‡πâ‡∏Å‡∏±‡∏ö‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£<br>- ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ô‡∏µ‡πâ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô, ‡∏Ñ‡πà‡∏≤‡∏à‡∏î‡∏à‡∏≥‡∏ô‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô<br>- ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà K Contact Center ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 0-2888-8888<br>- ‡∏Å‡∏£‡∏ì‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏ö‡∏ö‡πÇ‡∏õ‡∏∞(‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î) ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏ä‡∏≥‡∏£‡∏∞‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 1-2 ‡∏ß‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÉ‡∏´‡πâ‡∏ô‡∏≥‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏à‡πà‡∏≤‡∏¢‡πÇ‡∏õ‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÅ‡∏¢‡∏Å‡∏¢‡∏≠‡∏î ‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏ö‡∏ö‡πÇ‡∏õ‡∏∞‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏Ñ‡πà‡∏≤‡∏á‡∏ß‡∏î</p>
</div>`;
  document.getElementById('er').innerHTML=h;document.getElementById('er').classList.remove('hid');document.getElementById('er').scrollIntoView({behavior:'smooth'})
}

// Toggle flat/step PMT inputs
function togPmt(prefix){
  let mode=document.getElementById(prefix+'_t').value;
  document.getElementById(prefix+'_fd').classList.toggle('hid',mode!=='flat');
  document.getElementById(prefix+'_sd').classList.toggle('hid',mode!=='step');
}

// Validation helper
function vld(ids,labels){
  for(let i=0;i<ids.length;i++){
    let v=pn(document.getElementById(ids[i]).value);
    if(!v||v<=0){alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å '+labels[i]+' ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');document.getElementById(ids[i]).focus();return false;}
  }
  return true;
}


// Print: clone results into a clean #print-area, print, then remove
function doPrint(tab){
  let resMap={calc:'cr',cmp:'mr',ext:'er'};
  let resEl=document.getElementById(resMap[tab]);
  if(!resEl||resEl.classList.contains('hid')){alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå');return}

  // Remove old print area if exists
  let old=document.getElementById('print-area');
  if(old)old.remove();

  // Clone result content
  let clone=resEl.cloneNode(true);
  clone.classList.remove('hid');

  // Remove .rc (sales recommendation) from clone
  clone.querySelectorAll('.rc').forEach(el=>el.remove());

  // Show .print-info in clone
  clone.querySelectorAll('.print-info').forEach(el=>el.style.display='block');

  // Build print area with inline styles for A4
  let pa=document.createElement('div');
  pa.id='print-area';
  pa.innerHTML=buildPrintHTML(clone.innerHTML);
  document.body.appendChild(pa);

  window.print();
  setTimeout(()=>{let p=document.getElementById('print-area');if(p)p.remove()},500);
}

function buildPrintHTML(content){
  return `<style>
    #print-area{font-family:'IBM Plex Sans Thai',sans-serif;font-size:8px;color:#1a1a1a;line-height:1.3}
    #print-area .print-info{display:block;margin-bottom:4px}
    #print-area .pi-title{font-size:12px;font-weight:700;text-align:center;margin-bottom:2px;padding-bottom:3px;border-bottom:2px solid #22d3a7;color:#0b1120}
    #print-area .pi-title span{color:#0a8a6a}
    #print-area .pi-sub{font-size:7px;text-align:center;color:#888;margin-bottom:3px}
    #print-area .pi-bar{font-size:8px;color:#333;background:#f5f5f5;border:1px solid #ddd;border-radius:3px;padding:3px 8px;margin-bottom:4px;display:flex;flex-wrap:wrap;gap:2px 12px}
    #print-area .pi-bar b{color:#0b1120}
    #print-area .st{font-size:9px;font-weight:700;padding-bottom:2px;margin-bottom:3px;margin-top:5px;border-bottom:1px solid #ddd;color:#1a1a1a;display:flex;align-items:center;gap:4px}
    #print-area .g2{display:grid;grid-template-columns:1fr 1fr;gap:4px}
    #print-area .g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:4px}
    #print-area .sum-panel{border:1px solid #ccc;border-radius:4px;background:#fff;margin-bottom:3px;overflow:hidden}
    #print-area .panel-hdr{padding:2px 6px;font-size:8px;font-weight:700;border-bottom:1px solid #ddd;color:#1a1a1a}
    #print-area .panel-hdr.flat,#print-area .panel-hdr.bank-a{border-top:2px solid #22d3a7}
    #print-area .panel-hdr.step,#print-area .panel-hdr.bank-b{border-top:2px solid #38bdf8}
    #print-area .panel-hdr.diff{border-top:2px solid #fb7185}
    #print-area .panel-hdr.normal{border-top:2px solid #999}
    #print-area .panel-hdr.yearly{border-top:2px solid #d4a017}
    #print-area .panel-hdr.monthly{border-top:2px solid #22d3a7}
    #print-area .sum-row{display:flex;justify-content:space-between;align-items:center;padding:1px 6px;border-bottom:1px solid #f0f0f0}
    #print-area .sum-row:last-child{border-bottom:none}
    #print-area .sum-row .lbl{font-size:7.5px;color:#444}
    #print-area .sum-row .val{font-size:7.5px;font-weight:700;color:#1a1a1a}
    #print-area .val.grn{color:#0a8a6a!important}
    #print-area .val.blu{color:#1a7abf!important}
    #print-area .val.gld{color:#b8860b!important}
    #print-area .val.pnk{color:#d63384!important}
    #print-area .pos{color:#0a8a6a!important}
    #print-area .neg{color:#d63384!important}
    #print-area .tw{max-height:none;overflow:visible;border:1px solid #ccc;border-radius:3px}
    #print-area table{width:100%;border-collapse:collapse;font-size:7px}
    #print-area .sum-panel table{font-size:6px!important;margin-top:1px!important;line-height:1.1!important}
    #print-area .sum-panel table th{font-size:5.5px!important;padding:1px 2px!important;color:#888!important;font-weight:600!important;border-bottom:1px solid #ccc!important;background:#f8f8f8!important;text-align:right!important}
    #print-area .sum-panel table td{font-size:6px!important;padding:1px 2px!important;color:#555!important;border-bottom:1px solid #eee!important;text-align:right!important}
    #print-area .sum-panel table th:first-child,#print-area .sum-panel table td:first-child{text-align:center!important}
    #print-area .sum-panel table th[style],#print-area .sum-panel table td[style]{font-size:6px!important;padding:1px 2px!important}
    #print-area .y3w{overflow:visible!important}
    #print-area .y3t{table-layout:fixed!important;font-size:6px!important}
    #print-area th{background:#f0f0f0;color:#1a1a1a;padding:1.5px 3px;font-size:6.5px;font-weight:700;text-align:right;border-bottom:1px solid #ccc}
    #print-area td{padding:1px 3px;text-align:right;color:#333;border-bottom:1px solid #eee;font-size:7px}
    #print-area th:first-child,#print-area td:first-child{text-align:center}
    #print-area .bg-a,#print-area .bg-b,#print-area .bg-d{background:none;padding:0;color:inherit;font-weight:700}
    #print-area .disclaimer{margin-top:4px;padding-top:3px;border-top:1px solid #ccc;background:none!important;border-radius:0!important;border-left:none!important;border-right:none!important;border-bottom:none!important;padding:3px 0 0 0!important}
    #print-area .disclaimer h4{font-size:7px;font-weight:700;color:#666;margin:0 0 2px 0;display:block}
    #print-area .disclaimer p{font-size:6.5px;color:#888;line-height:1.5;margin:0;display:block}
    #print-area .hid{display:none}
    #print-area .accent{color:#0a8a6a}
  </style>${content}`;
}

</script>
</body>
</html>
